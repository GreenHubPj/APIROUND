<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>리뷰 작성 - GreenHub</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">
    <link rel="stylesheet" th:href="@{/css/review.css}">
</head>
<body>
<!-- 헤더 포함 -->
<div th:replace="~{common/header :: header}"></div>

<div class="container">
    <!-- 사용자 프로필 섹션 (로그인 상태) -->
    <div class="user-profile-section" th:if="${currentUser != null}">
        <div class="profile-avatar">
            <!-- 이니셜 1글자 -->
            <div class="avatar-placeholder"
                 th:text="${#strings.substring(currentUser.name,0,1)}">?</div>
        </div>
        <div class="user-info">
            <!-- 이름(마스킹: 4글자 초과면 뒤를 *** 처리) -->
            <h1 class="user-name"
                th:text="${
            #strings.length(currentUser.name) > 3
              ? #strings.substring(currentUser.name,0,4) + '***님'
              : currentUser.name + '님'
          }">사용자님</h1>
        </div>
    </div>

    <!-- 사용자 프로필 섹션 (비로그인 상태) -->
    <div class="user-profile-section" th:if="${currentUser == null}">
        <div class="profile-avatar">
            <div class="avatar-placeholder">?</div>
        </div>
        <div class="user-info">
            <h1 class="user-name">로그인이 필요합니다</h1>
        </div>
    </div>

    <!-- 리뷰 탭 섹션 -->
    <div class="review-tabs">
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="writable">작성 가능한 리뷰</button>
            <button class="tab-button" data-tab="written">작성한 리뷰</button>
        </div>

        <!-- 작성 가능한 리뷰 탭 -->
        <div class="tab-content active" id="writable">
            <div class="review-list">
                <!-- (샘플 카드들은 그대로 두되, 실제 화면에서는 JS가 대체 렌더링) -->
                <div class="review-item">
                    <div class="product-image"><img src="/images/제철 당근.jpg" alt="제철 당근" class="product-img"></div>
                    <div class="product-info">
                        <div class="store-name">Yoyo Farm</div>
                        <div class="product-name">제철 당근</div>
                        <div class="product-description">가을철 영양의 보고/비타민A가 풍부한 당근으로 면역력 강화에 도움을 줍니다.</div>
                        <div class="product-details">
                            <span class="price">6000원 / kg</span>
                            <span class="origin">제주 구좌읍</span>
                        </div>
                    </div>
                    <div class="review-actions">
                        <button class="write-review-btn">리뷰 작성하기</button>
                    </div>
                </div>

                <div class="review-item">
                    <div class="product-image"><img src="/images/굴비찜.jpg" alt="굴비찜" class="product-img"></div>
                    <div class="product-info">
                        <div class="store-name">미자 생선가게</div>
                        <div class="product-name">굴비찜</div>
                        <div class="product-description">전통 방식으로 만든 굴비립입니다. 깊은 맛과 향이 일품입니다.</div>
                        <div class="product-details">
                            <span class="price">45000원 / 마리</span>
                            <span class="origin">전남 영광</span>
                        </div>
                    </div>
                    <div class="review-actions">
                        <button class="write-review-btn">리뷰 작성하기</button>
                    </div>
                </div>

                <div class="review-item">
                    <div class="product-image"><img src="/images/인기 감자.jpg" alt="인기 감자" class="product-img"></div>
                    <div class="product-info">
                        <div class="store-name">동글이네</div>
                        <div class="product-name">제철 감자</div>
                        <div class="product-description">가을철 든든한 에너지/신선하고 맛있는 감자로 가을 요리를 완성하세요.</div>
                        <div class="product-details">
                            <span class="price">7000원 / kg</span>
                            <span class="origin">강원 평창</span>
                        </div>
                    </div>
                    <div class="review-actions">
                        <button class="write-review-btn">리뷰 작성하기</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 작성한 리뷰 탭 -->
        <div class="tab-content" id="written">
            <div class="review-list">
                <div class="written-review-item">
                    <div class="product-image"><img src="/images/제철 당근.jpg" alt="제철 당근" class="product-img"></div>
                    <div class="review-content">
                        <div class="product-info">
                            <div class="store-name">Yoyo Farm</div>
                            <div class="product-name">제철 당근</div>
                            <div class="delivery-date">2025.09.08 배송완료</div>
                        </div>
                        <div class="review-preview">
                            <div class="star-rating"><span class="star active">★</span><span class="star active">★</span><span class="star active">★</span><span class="star active">★</span><span class="star active">★</span></div>
                            <p class="review-text">당근이 너무 신선하고 배송도 빨랐어요! 유기농이라서 우리 아이에게 안심하고 먹을 수 있어요. 다 먹으면 재구매 할게요 감사합니다.</p>
                        </div>
                    </div>
                    <div class="review-actions">
                        <button class="edit-review-btn">리뷰 수정하기</button>
                        <button class="hide-btn">숨기기</button>
                    </div>
                </div>

                <div class="written-review-item">
                    <div class="product-image"><img src="/images/굴비찜.jpg" alt="굴비찜" class="product-img"></div>
                    <div class="review-content">
                        <div class="product-info">
                            <div class="store-name">미자 생선가게</div>
                            <div class="product-name">굴비찜</div>
                            <div class="delivery-date">2025.08.23 배송완료</div>
                        </div>
                        <div class="review-preview">
                            <div class="star-rating"><span class="star active">★</span><span class="star active">★</span><span class="star active">★</span><span class="star active">★</span><span class="star">★</span></div>
                            <p class="review-text">전통 방식으로 만든 굴비찜이 정말 맛있었어요. 깊은 맛과 향이 일품이었습니다. 다음에도 주문할 예정입니다.</p>
                        </div>
                    </div>
                    <div class="review-actions">
                        <button class="edit-review-btn">리뷰 수정하기</button>
                        <button class="hide-btn">숨기기</button>
                    </div>
                </div>

                <div class="written-review-item">
                    <div class="product-image"><img src="/images/인기 감자.jpg" alt="인기 감자" class="product-img"></div>
                    <div class="review-content">
                        <div class="product-info">
                            <div class="store-name">동글이네</div>
                            <div class="product-name">제철 감자</div>
                            <div class="delivery-date">2025.06.22 배송완료</div>
                        </div>
                        <div class="review-preview">
                            <div class="star-rating"><span class="star active">★</span><span class="star active">★</span><span class="star active">★</span><span class="star">★</span><span class="star">★</span></div>
                            <p class="review-text">감자가 신선하고 맛있었어요. 가을 요리에 딱이었습니다. 포장도 깔끔하게 잘 되어있었네요.</p>
                        </div>
                    </div>
                    <div class="review-actions">
                        <button class="edit-review-btn">리뷰 수정하기</button>
                        <button class="hide-btn">숨기기</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 푸터 포함 -->
<div th:replace="~{common/footer :: footer}"></div>

<script th:src="@{/js/review.js}"></script>
</body>
</html>
